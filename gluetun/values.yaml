statefulset:
  gluetun: # Renamed from 'app' to 'gluetun'
    nodeSelector:
      app: mediabox
    image:
      repository: "qmcgaw/gluetun"
      tag: latest
    # Environment variables for Gluetun configuration
    env:
      VPN_SERVICE_PROVIDER: nordvpn
      VPN_TYPE: wireguard
      SERVER_REGIONS: Europe
      SERVER_CATEGORIES: "Standard VPN servers,P2P"
      TZ: Europe/London
      UPDATER_PERIOD: 24h
      UPDATER_VPN_SERVICE_PROVIDERS: nordvpn
      # Enable SOCKS5 proxy
      DOT_SOCKS_ENABLED: "on"
      # Allow incoming connections on qBittorrent port through VPN
      FIREWALL_VPN_INPUT_PORTS: "6881"
    # Secret reference for sensitive data
    secrets:
      existingSecret: gluetun-wireguard-secret # This secret should be created separately
    # Security context for network capabilities
    securityContext:
      capabilities:
        add: ["NET_ADMIN"]
  replicas: 1
persistentVolumeClaim:
  storage: 1Gi # Reduced size as Gluetun config is small
  storageClass: longhorn
service:
  ports:
  - port: 8888 # Gluetun UI port
    protocol: TCP
    targetPort: 8888
    name: http-ui
  - port: 1080 # SOCKS5 proxy port
    protocol: TCP
    targetPort: 1080
    name: socks5
  - port: 6881 # qBittorrent torrenting port (TCP)
    protocol: TCP
    targetPort: 6881
    name: qbt-tcp
  - port: 6881 # qBittorrent torrenting port (UDP)
    protocol: UDP
    targetPort: 6881
    name: qbt-udp
  type: ClusterIP
ingress:
  enabled: false
  rules:
    host: gluetun.mediabox.local
